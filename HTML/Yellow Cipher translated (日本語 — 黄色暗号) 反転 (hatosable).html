<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>反転黄色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha {
            font-size: 13px;
        }
        .dark img.ondark {
            filter: invert(87%);
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転黄色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：反転黄色暗号</h2>
                <p class="flavour-text">「黄色い歓声が聞こえてくるよ！」 - そんなこと暗号は決して言わない。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中と下のディスプレーに暗号化された数字が表示される。</p>
                <p>ページ2には、上のディスプレーに別の暗号化された数字、真ん中のディスプレーに8文字の単語、下のディスプレーにダッシュ(-)で区切られた4つの数字が表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ1：モービット暗号</h3>
                <p>最初に必要なことは、ページ1の真ん中と下及びページ2の上のディスプレーに表示された、3つの暗号化された数字を復号することである。3つの数字を記載された順に連結させる。</p>
                <p>次にページ2の真ん中のディスプレーに表示された単語を取得し、単語の下に、アルファベットの昇順になるように1から8の番号を記入する。同率の英字がある場合、更にそれを読み順で振る。例：OPTIMISM -> 56813274</p>
                <p>そして、8桁のキーの真下に以下の文字列を記入する。</p>
                <p class="centered">
                    ...---xx<br>
                    .-x.-x.-
                </p>
                <p>今あるはずのものは、それぞれの数字がその下の記号に変換されて示されるキーである。</p>
                <p>暗号化された数字の全体を取得し、鍵を使用してドットとダッシュとXに変換する。これをモールス信号として読む。Xは英字同士のスペースを示す。</p>
            </div>
            <div class="page-footer relative-footer">ページ 1/4</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転黄色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">モールス信号表</h4>
                <img class="ondark" src="img/Morse Code/morse-signals.svg" style="width: 90%">
                <p>これで復号された単語が手に入るはずである。これは、ステップ3で使用するキーワードとなる。</p>
                <h4 class="centered">例</h4>
                <table style="text-align:center">
                    <tr><th>F</th><th>O</th><th>U</th><th>N</th><th>T</th><th>A</th><th>I</th><th>N</th></tr>
                    <tr><th>2</th><th>6</th><th>8</th><th>4</th><th>7</th><th>1</th><th>3</th><th>5</th></tr>
                    <tr><th>.</th><th>.</th><th>.</th><th>-</th><th>-</th><th>-</th><th>x</th><th>x</th></tr>
                    <tr><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th><th>x</th><th>.</th><th>-</th></tr>
                </table>
                <p class="centered">
                    4 4 5 7 5 1 8 | - . - . x - - - x - - x . x | C O M E
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 2/4</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転黄色暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ2: ヒル暗号</h3>
                <p>ここでは、ページ1の上のディスプレーに表示された暗号化された単語とページ2の下のディスプレーにある4つの数字が必要になる。数字は「A-B-C-D」のように読む。</p>
                <p>幸いにも、全ての英字は4つの数字の逆数が乗算済みである。4桁の数字を次のように配置すればよい。</p>
                <table style="text-align:center">
                    <tr><th>A</th><th>B</th></tr>
                    <tr><th>C</th><th>D</th></tr>
                </table>
                <p>各数字にNを掛け、モジュロ26を求める(0から25の範囲になるまで、26を繰り返し引く)。</p>
                <p>暗号化された単語をペアに分割する。各ペアに対して以下の手順に従う。</p>
                <ul>
                <li>両方の英字を、アルファベット上の位置の数字に変換する。</li>
                    <li>一つ目の数字に左上の数字を掛ける。 </li>
                    <li>二つ目の数字に右上の数字を掛ける。</li>
                    <li>二つの数字を合計し、モジュロ26を求め、それを英字に戻すと最初の英字を獲得できる(Z = 0)。</li>
                    <li>一つ目の元の値(乗算する前の値)に左下の数字を掛ける。</li>
                    <li>二つ目の元の値(乗算する前の値)に右下の数字を掛ける。</li>
                    <li>二つの数字を合計し、モジュロ26を求め、それを英字に戻すと二番目の英字を獲得できる(Z = 0)。</li>
                </ul>
                <p>結果の文字列が、新たな暗号化された単語となる。</p>

            </div>
            <div class="page-footer relative-footer">ページ 3/4</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転黄色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">例</h4>
                <table style="text-align:center">
                    <tr><th>1</th><th>16</th></tr>
                    <tr><th>17</th><th>21</th></tr>
                </table>
                <p class="centered">
                    LI -> 12 9 <br>
                    RQ -> 18 17 <br>
                    HC -> 8 3 <br>
                    (1 * 12) + (16 * 9) % 26 = 0 => Z <br>
                    (17 * 12) + (21 * 9) % 26 = 3 => C <br>
                    (1 * 18) + (16 * 17) % 26 = 4 => D <br>
                    (17 * 18) + (21 * 17) % 26 = 13 => M <br>
                    (1 * 8) + (16 * 3) % 26 = 4 => D <br>
                    (17 * 8) + (21 * 3) % 26 = 17 => Q <br>
                    新たな暗号化された単語：ZCDMDQ
                </p>
                <h3>ステップ3：トライフィド暗号</h3>
                <p>まずキーを作成する必要がある。そのためには、ステップ1の復号されたキーワードを取得し重複する英字の2文字目以降を削除する。アルファベット全体の文字列を取得し、キーワードに表示された英字を削除する。</p>
                <p>バッテリーの本数が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>最後に、キーの真下に以下の段を配置する。</p>
                <p class="centered">
                    11111111122222222233333333<br>
                    11122233311122233311122233<br>
                    12312312312312312312312312
                </p>
                <p>ステップ2で獲得した暗号化された単語に対して、上記の先程作成したキーを用いて各英字を3桁の数字に変換する。その後、左から縦に3つの数字を書き、6桁の数字を3段用意する。</p>
                <p>数字を上から横に読むことで新たな数列を獲得する。それから、先程作成したキーを用いて各3桁ごとにそれを英字に戻す。</p>
                <p>結果の文字列が復号された単語となる。</p>
            </div>
            <div class="page-footer relative-footer">ページ 4/4</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転黄色暗号</span>
            </div>
            <div class="page-content">

                <h4 class="centered">例</h4>
                <table class = "alpha">
                    <tr><th>C</th><th>O</th><th>M</th><th>E</th><th>A</th><th>B</th><th>D</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>N</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                    <tr><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th><th>3</th></tr>
                    <tr><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th><th>3</th><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th><th>3</th><th>1</th><th>1</th><th>1</th><th>2</th><th>2</th><th>2</th><th>3</th><th>3</th></tr>
                    <tr><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th><th>3</th><th>1</th><th>2</th></tr>
                </table>
                <p class="centered">
                    ZCDMDQ -> 332 111 131 113 131 232
                </p>
                <table style="text-align:center">
                    <tr><th>3</th><th>1</th><th>1</th><th>1</th><th>1</th><th>2</th></tr>
                    <tr><th>3</th><th>1</th><th>3</th><th>1</th><th>3</th><th>3</th></tr>
                    <tr><th>2</th><th>1</th><th>1</th><th>3</th><th>1</th><th>2</th></tr>
                </table>
                <p class="centered">
                    311 112 313 133 211 312 -> SOUGHT
                </p>

                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>
                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>
                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 4/4</div>
        </div>
    </div>
</body>
</html>