<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>腐敗 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .nodes {
            width: 7em;
            float: right;
            margin-left: .5em;
            margin-bottom: .5em;
        }

        @media screen and (min-width: 900px), print {
            .nodes {
                width: 13em;
                margin-left: 1em;
                margin-bottom: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">腐敗</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Decay.svg" class="diagram">
                <h2>モジュール詳細：腐敗</h2>
                <p class="flavour-text">何もかもが崩れ落ちる...</p>
                このモジュールには押すことのできる記号が3つ表示されている。
                モジュールを解除するには、正しい順序で記号を押す必要がある。
                専門用語は全てマニュアルの最後で解説される。
                
                <h3>ステップ1: 超複雑素因数分解</h3>
                <p class="flavour-text">...数も...</p>
                <h4>ステップ1.1: ディスプレーの解読</h4>
                モジュールには3つの暗号化された記号が表示されている。
                それぞれの記号を解読するには、縦線を二進数の桁として解釈する。下の線に接続されている縦線は1、下の線に接続されていない縦線は0とする。kを記号に存在する縦線の数とし、2<sup>k</sup>-1をこの値に加算する。
                こうして得られる3つの数字を十五進数の各桁とみなし、全体を十進数に変換する。
                この番号をnとする。

                <h4>ステップ1.2: 木の作成</h4>
                ノードと枝からなる木を作成する。
                木を作成するには、[V<sub>p</sub>=0; V<sub>r</sub>=n]であるノードから開始する。
                V<sub>r</sub>の素因数P(重複は別々に数える)ごとに、子ノード[V<sub>p</sub>=P; V<sub>r</sub>=(V<sub>r,親</sub>/P)+1]を作成する。
                子ノードをV<sub>p</sub>の昇順に並べる。
                この操作をV<sub>r</sub>が素数でないすべてのノードに対して適用する。
                こうして作られるノードの集合をTとする。
            </div>
            <div class="page-footer relative-footer">ページ 1/5</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">腐敗</span>
            </div>
            <div class="page-content">
              <h3>ステップ2: ニューラルネットワークビットカスケード</h3>
              <p class="flavour-text">...モジュールも...</p>
              <h4>ステップ2.1: 二進数の作成</h4>
              左右の記号を押す前であれば、中央の記号はいつでも自由に押すことができる。
              中央の記号を押すと、7つの音からなるシーケンスが再生される。
              このシーケンスを7桁の二進数に変換する。
              それぞれの音は、次の音の方が高ければ1、そうでなければ0に変換される。
              最後の音に関しては、「次の音」とは最初の音を指す。
              この数列をB<sub>i</sub>とする。
              空の数列B<sub>f</sub>を用意する。
              kを1とし、操作
             「B<sub>i</sub>の先頭k桁を取り(必要であればB<sub>i</sub>を繰り返す)、反転してからB<sub>f</sub>の末尾に追加する」を行う。
              kをk+1に変えて繰り返す。
              次のステップに必要な桁数が得られるまでこの操作を繰り返す。
              必要であればいつでも追加で桁を生成することができる。
              B<sub>f</sub>のビットを使うように求められたときは、まだ使われていない先頭のビットを利用する。

              <h4>ステップ2.2: 枝への値の割り当て</h4>
              ベースノードから開始し、子に順番に訪れる。
              さらにこの子から、子ノードが無いノードに訪れるまで子ノードに順番に訪れる。その後、直前に通った枝に
              [b<sub>親</sub>=B<sub>f,今回</sub>]を割り当てる。
              あるノードのb<sub>子</sub>が全て割り当てられたら、そのノードと親ノードを繋ぐ枝に[b<sub>親</sub>=Σ(b<sub>子</sub>)%2]を割り当てる。
              全ての枝に対しbが割り当てられるまで、この操作を繰り返す。

              <h4>ステップ2.3: 逆伝播</h4>
              ベースノードから開始し、[V<sub>b</sub>=1]にする。
              子に移動し、[V<sub>b</sub>=V<sub>b,親</sub>⊻b<sub>親</sub>]にする。
              この操作により全てのノードに対して値を割り当てる。
            </div>
            <div class="page-footer relative-footer">ページ 2/5</div>
        </div>

        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">腐敗</span>
            </div>
            <div class="page-content">
              <h3>ステップ3: 量子論理</h3>
              <p class="flavour-text">...そして最後には...</p>

              <h4>ステップ3.1: 初期シーケンスの決定</h4>
              [S<sub>1</sub>=Σ(V<sub>p</sub>); S<sub>2</sub>=Σ(V<sub>p</sub>*V<sub>b</sub>)]であるシーケンスSを作成する。
              S<sub>最後</sub>が0でなくなるまで、Sの末尾に[S<sub>最後から2番目</sub>⨬S<sub>最後</sub>]を追加する。

              <h4>ステップ3.2: 分数の作成</h4>
              Sの長さをbとし、nをb進数に変換したあと、それぞれの桁をシーケンスS2の要素とする。
              S2の長さが奇数であれば、S2の最初に0を追加する。
              S2が作成できたら、各kに対し[S2<sub>k</sub>=S<sub>S2<sub>k</sub>+1</sub>]にする。
              これらの番号を2つずつのペアに分け、小さい数/大きい数として分数を作成する。
              ただし、0/0は1/2に変換する。
              この分数の集合をFとする。</p>

              <h4>ステップ3.3: 真理値表の作成</h4>
              論理を使うためには真理値表が必要である。
              真理値表を作成するためには、B<sub>f</sub>から2<sup>Fの長さ</sup>ビットを取得する。
              それぞれのビットは[Fの長さ]桁の0と1の一意的な組み合わせに対応する。
              [Fの長さ]桁の二進数を昇順に並べ、先ほど取得したB<sub>f</sub>のビットを出力結果として関連づける。
              この真理値表をTTとする。

              <h4>ステップ3.4: 量子論理の適用</h4>
              f=0から開始する。
              TT<sub>k,出力</sub>=1であるような各kに対し、操作
              「TT<sub>k,p</sub>=0であるような各pに対し、一時的に[F<sub>p</sub>=1-F<sub>p</sub>]と変更する」を適用する。
              [f=f+Π(F)]に更新し、一時的に変更した値を元に戻す。
              fは常に分数の形で表しておく。
            </div>
            <div class="page-footer relative-footer">ページ 3/5</div>
        </div>

        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">腐敗</span>
            </div>
            <div class="page-content">
              <h3>ステップ4: 送信</h3>
              <p class="flavour-text">...正気すらも。</p>
              <h4>ステップ4.1: 送信するシーケンスの特定</h4>
              空のシーケンスS3を作成する。
              ⌊f⌋をS3の末尾に追加し、[f=1/(f%1)]にする。
              これをfの分子が0になるまで続ける。

              <h4>ステップ4.2: 回答の送信</h4>
              S3を送信するには、それぞれの数字を二進数に変換する。
              左の記号を0、右の記号を1とし、最上位桁から順番に入力する。
              中央のシンボルを押すと現在の入力を送信シーケンスに追加する。
              中央のシンボルを連続で2回押すと現在の送信シーケンスが送信される。
            </div>
            <div class="page-footer relative-footer">ページ 4/5</div>
        </div>

        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">腐敗</span>
            </div>
            <div class="page-content">
              <h3>用語解説</h3>
              <h4>記号</h4>
              <ul>
                <li>Σ(k): kの全ての和を返す。</li>
                <li>Π(k): kの全ての積を返す。</li>
                <li>a%b: aのbによる剰余。aをbで割った余りを返す。</li>
                <li>a⨬b: aのbによる簡約剰余。「aからbを引き、bから1を引く」という操作を、aがbより小さくなるかbが0になるまで繰り返す。bが0になった場合は0を返し、そうでなければaを返す。</li>
                <li>⌊k⌋: kの床関数。kの小数点以下を切り捨てた値を返す。</li>
                <li>a⊻b: aとbの排他的論理和。片方のみの入力が1のときには1を返し、そうでなければ0を返す。</li>
                <li>a<sub>b</sub>: aが集合であり、その中から特定の要素を使用する時に用いる。bに応じた値を返す。いくつかの記号は、bに加えて補助的な変数が用意されているものがある。
                <ul>
                    <li>V<sub>r,親</sub> = 親のV<sub>r</sub></li>
                    <li>B<sub>f,今回</sub> = B<sub>f</sub>のうち今回使用すべきビット</li>
                    <li>TT<sub>k,p</sub> = TT内の上からk番目の組み合わせにおけるp番目の入力。pが出力の場合、出力ビットを参照する</li>
                </ul>
                </li>
              </ul>
              
              <h4>用語と操作</h4>
              <img src="img/Decay/node.svg" class="nodes invertible">
              <ul>
                <li>基数の変換 (b->10): b進数を十進数に変換するには、回答を0から開始し、左から順に、各桁を取得した後に回答をb倍してその桁を足す、という操作を繰り返す。</li> 
                <li>基数の変換 (10->b): 10進数をb進数に変換するには、空の数列から開始する。数をbで割った剰余を求め、数列の末尾に追加する。その後に数をbで割り小数点以下を切り捨てる。この操作を数が0になるまで繰り返す。</li>
                <li>ビット: 長さ1の二進数表記の文字。0または1のどちらかになる。</li>
                <li>素数: 1と自分自身でしか割り切れない数。1は素数ではない。</li>
                <li>素因数: ある数を割り切れる素数。素数の累乗で割り切れる場合は、その素数を複数回数える。</li>
                <li>ノード: 右図を参照。各ノードには主数V<sub>p</sub>、剰余V<sub>r</sub>、二進数V<sub>b</sub>が割り当てられている。ベースノード以外の全てのノードには1つ前のノード(親)が存在する。また、子が存在するノードもある。あるノードAが別のノードBを親として持つとき、ノードAをノードBの子と呼ぶ。</li>
                <li>枝: 2つのノード間の繋がり。それぞれの枝には、ある二進数bが割り当てられている。この値は枝に接続されている親もしくは子の二進数が参照しており、二進数を反転させる役割がある。</li>
              </ul>
            </div>
            <div class="page-footer relative-footer">ページ 5/5</div>
        </div>
    </div>
</body>

</html>