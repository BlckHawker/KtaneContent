<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>反転珊瑚色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            margin: 1em auto;
            border: none;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha {
            font-size: 13px;
        }
        .tablea {
            font-size: 14px;
        }
        .tableb {
            font-size: 20px;
            width: 100%;
        }
        p.center { text-align:center; }
    </style>
</head>
<body>
<div class="section">
    <div class="page page-bg-01">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
            <span class="page-header-section-title">反転珊瑚色暗号</span>
        </div>
        <div class="page-content">
            <img src="img/Component/Ultimate Cipher.svg" class="diagram">
            <h2>モジュール詳細：反転珊瑚色暗号</h2>
            <p class="flavour-text">コーラルにより、この暗号は強化されています。 - エア</p>

            <p>モジュールは、3つのディスプレー、キーボード、左右の矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
            <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
            <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーにキーワード、下のディスプレーには数字が表示される。</p>
            <p>ページ2には、上のディスプレーに別のキーワードが表示される。</p>
            <p>以下のルールに従って単語を解読する。</p>
            <h3>ステップ1：GROMARK暗号</h3>
            <p>ここでは、1ページ目で取得した暗号化された単語と2ページ目の上のディスプレーに表示されたキーが必要になる。</p>
            <p>キーワードの下に、アルファベットの昇順で数字を記入する。同じ英字がある場合、それらは読み順で数字を記入する。これが数字キーである。</p>
            <p>キーワードを取得し、最初に出現した英字以外の重複する英字を削除する。アルファベットの文字列全体を取り出し、キーワードに表示されている英字をすべて削除する。</p>
            <p>ポートの個数を4で割った余りが2以上の場合、キーワードの末尾にアルファベットを配置する。そうでない場合、キーワードの先頭にアルファベットを配置する。これがアルファベットキーである。</p>
            <p>キーの列が合うように、数字キーの真下にアルファベットキーを読み順で記入する。アルファベットキーを数字の昇順で縦に読み、最終的なアルファベットキーを取得する。アルファベットキーの真下に通常のアルファベットの文字列を記入する。</p>
            <p>新しい数字キーを作成する。この数字キーは、先頭3桁が元の数字キーであり、その末尾にある3桁が追加される。その3桁は数字キーの先頭2桁の和を10で割った余り、先頭から2番目の2桁の和を10で割った余り…のようにして求める。</p>
        </div>
        <div class="page-footer relative-footer">ページ 1/4</div>
    </div>

    <div class="page page-bg-02">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
            <span class="page-header-section-title">反転珊瑚色暗号</span>
        </div>
        <div class="page-content">
            <p>暗号化された単語の各英字に対して、以下の処理を行う。</p>
            <ul>
                <li>暗号化された単語のN番目の文字を上段から探す。</li>
                <li>数字キーのN番目の数字だけ右に移動する。</li>
                <li>その真下にある英字が、復号された英字である。</li>
            </ul>
            <h4 style="text-align:center">例</h4>
            <P class="center">
                暗号化された単語：UHXCSO<br>
                キーワード：JEALOUS
            </p>
            <P class="center">
                JEALOUS<br>
                3214576
            </p>
            <table>
                <tr><td>3</td><td>2</td><td>1</td><td>4</td><td>5</td><td>7</td><td>6</td></tr>
                <tr><td>B</td><td>C</td><td>D</td><td>F</td><td>G</td><td>H</td><td>I</td></tr>
                <tr><td>K</td><td>M</td><td>N</td><td>P</td><td>Q</td><td>R</td><td>T</td></tr>
                <tr><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td><td>J</td><td>E</td></tr>
                <tr><td>A</td><td>L</td><td>O</td><td>U</td><td>S</td><td class='empty'></td><td class='empty'></td></tr>
            </table>
            <P class="center">
                最終的なアルファベットキー：DNXOCMWLBKVAFPYUGQZSITEHRJ
            </p>
            <P class="center">
                数字キー：321 -> 321536
            </p>
            <P class="center">
                U, 3 -> X -> H<br>
                H, 2 -> J -> K<br>
                X, 1 -> Y -> R<br>
                C, 5 -> H -> L<br>
                S, 3 -> V -> T<br>
                O, 6 -> U -> I
            </p>
            <P class="center">
                復号された単語：HKRLTI
            </p>
            <h3>ステップ2：AMSCO転置</h3>
            <p>1ページ目の下のディスプレーにある数字キーを取り、キーの列に収まるように、その真下に読み順で4つの「セル」を置く。</p>
            <p>シリアルナンバーの一番目の文字(A = 10,B = 11...Z = 35)が奇数の場合、各セル内に入れられる文字列の長さは読み順で{1, 2, 1, 2}である。そうでない場合、各セル内に入れられる文字列の長さは読み順で{2, 1, 2, 1}である。</p>
        </div>
        <div class="page-footer relative-footer">ページ 2/4</div>
    </div>
    <div class="page page-bg-03">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
            <span class="page-header-section-title">反転珊瑚色暗号</span>
        </div>
        <div class="page-content">
            <p>ステップ1で取得した暗号化された単語の各文字を、各セルが全て埋まるように、読み順で配置する。その後、文字を数字の昇順で読み、新しい暗号化された単語を取得する。</p>
            <h4 style="text-align:center">例</h4>
            <P class="center">
                暗号化された単語：HKRLTI<br>
                キー：321<br>
                文字列の長さ：2121
            </p>
            <table>
                <tr>
                    <td>3</td>
                    <td>2</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>HK</td>
                    <td>R</td>
                    <td>LT</td>
                </tr>
                <tr>
                    <td>I</td>
                    <td class='empty'></td>
                    <td class='empty'></td>
                </tr>
            </table>
            <P class="center">
               新たな暗号化された単語：LTRHKI
            </p>
<h3>ステップ3：プリッシー暗号</h3>
            <p>1ページ目の真ん中のディスプレーからキーワードを取り出し、重複する文字を削除する。アルファベット全体を取り出し、キーワードに表示されている文字をすべて削除する。</p>
            <p>ポートの個数が奇数である場合、キーワードの末尾にアルファベットを配置する。そうでない場合、キーワードの先頭にアルファベットを配置する。その後、そのキーを半分に分割し、後半のキーを前半のキーの真下に配置する。</p>
            <p>シリアルナンバーの四番目の文字(A = 1,B = 2...Z = 26)を13で割った余りをオフセットとして開始し、ステップ2で獲得した暗号化された単語の各文字ごとに以下の処理を実行する。</p>
            <ul>
                <li>キーの中から暗号化された単語のN番目の文字を見つける。</li>
                <li>その場所からオフセットの値だけ右に移動する。左端は同じ段の右端と繋がっている。</li>
                <li>到達した英字の真上/真下にある英字が復号された英字である。</li>
                <li>オフセットと暗号化された単語のN番目の文字を13で割った余りを求める。これが新しいオフセットである。</li>
            </ul>
            
            </div>
            <div class="page-footer relative-footer">ページ 3/4</div>
        </div>
    <div class="page page-bg-04">
        <div class="page-header">
            <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
            <span class="page-header-section-title">反転珊瑚色暗号</span>
        </div>
        <div class="page-content">
            <h4 style="text-align:center">例</h4>
            <P class="center">
                暗号化された単語：LTRHKI<br>
                キー：IMAGESBCDFHJKLNOPQRTUVWXYZ<br>
                オフセット：J -> 10 -> 10
            </p>
            <P class="center">
                L -> X -> H オフセット：10 + 12 -> 22 -> 9<br>
                T -> O -> A オフセット：9 + 20 -> 29 -> 3<br>
                R -> V -> D オフセット：3 + 18 -> 21 -> 8<br>
                H -> S -> R オフセット：8 + 8 -> 16 -> 3<br>
                K -> A -> O オフセット：3 + 11 -> 14 -> 1<br>
                I -> M -> N
            </p>
            <P class="center">
                復号された単語：HADRON
            </p>
            <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>

            <p>入力を消去するには、いずれかの英字をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>

            <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>

            </div>
            <div class="page-footer relative-footer">ページ 4/4</div>
        </div>
    </div>
</body>
</html>