<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>A-button-ing Mazes — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/jquery.3.7.0.min.js"></script>
    <script src="js/Utilities/svg-utils.js"></script>
    <script>
    $(function() {
        let grid = $(".holder");

        let rows = 5;
        let cols = 5;
        let h = 100;
        let w = 100;

        const mazes = 12;
        let netRotation = Array(mazes).fill(0);
        let netflipX = Array(mazes).fill(1);
        let netflipY = Array(mazes).fill(1);
        for (let net = 0; net < grid.length; net++) {
            let el = $(grid[net]);
            let svg = MakeSvgTag(500,500);
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    let cell = MakeSvgElem("rect", {
                        class: "highlightable", x:(c*w), y:(r*h),
                        width:w, height:h, fill:"transparent"
                    });
                    svg.append(cell);
                }
            }
            el.find(".imgs").append(svg);
            el.find(".imgs").addClass(`g${net}`);

            let buttons = $("<div>").addClass("hstack").prependTo(el);
            $("<button>").addClass("rotatenet bg-ccw").appendTo(buttons).click(function() {
                netRotation[net] -= 1;
                rotateFlipNetShape(net, netRotation[net], netflipX[net], netflipY[net]);
            });
            $("<button>").text("0").appendTo(buttons).click(function() {
                netRotation[net] = 0;
                netflipX[net] = 1;
                netflipY[net] = 1;
                rotateFlipNetShape(net, netRotation[net], netflipX[net], netflipY[net]);
            });
            $("<button>").addClass("flipnet").appendTo(buttons).click(function() {
                flipNetShape(net);
            });
            $("<button>").addClass("rotatenet bg-cw").appendTo(buttons).click(function() {
                netRotation[net] += 1;
                rotateFlipNetShape(net, netRotation[net], netflipX[net], netflipY[net]);
            });
        }

        function rotateFlipNetShape(n, r, nfX, nfY) {
            $(`.imgs.g${n}`).css("transform", `rotate(${90*r}deg) scale(${nfX}, ${nfY})`);
        }

        function flipNetShape(n) {
            let r = netRotation[n];
            if (r % 2 == 0) { netflipX[n] *= -1; }
            else { netflipY[n] *= -1; }
            rotateFlipNetShape(n, r, netflipX[n], netflipY[n]);
        }
    });
    </script>
    <script src="js/ktane-utils.js"></script>
    <style>
        .dark table, table {
            border: none;
            margin: 1em auto;
            width: 100%;
        }
        .holder {
            margin: 5px 10px 0;
        }
        .imgs {
            width: 200px;
            height: 200px;
            position: relative;
            transition: .6s;
        }
        .imgs img, .imgs svg {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
        }

        button {
            margin: 1px 4px;
            border: black 2px solid;
            border-radius: 3px;
            transition: .6s;
            display: block;
            font-family: "Special Elite";
            height: 19px;
            width: 34px;
            line-height: 19px;
            font-weight: bold;
            background-size: 30px 64px;
            background-position: 2px -20px;
            background-repeat: no-repeat;
            display: flex;
            justify-content: center;
        }
        button.rotatenet {
            height: 19px;
            width: 34px;
        }
        .bg-ccw {
            background-image: url('img/Common/ccw-arrow.svg');
        }
        .bg-cw {
            background-image: url('img/Common/cw-arrow.svg');
        }
        button.rotatenet.bg-ccw {
            background-size: 27px 60px;
            background-position: 2px -22.5px;
        }
        button.rotatenet.bg-cw {
            background-size: 27px 57px;
            background-position: 2px -21px;
        }
        button.flipnet {
            height: 19px;
            width: 34px;
            font-family: 'Logic-round';
            line-height: 15px;
            padding: 0;
            font-size: 23px;
        }
        button.flipnet::after { content: '↔'; }
        button.bg-ccw:hover {
            background-image: url('img/Common/ccw-arrowW.svg');
        }
        button.bg-cw:hover {
            background-image: url('img/Common/cw-arrowW.svg');
        }
        button:hover {
            color: white;
            background-color: black;
        }
        .dark .imgs img { filter: invert(.85) hue-rotate(180deg); }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">A-button-ing Mazes</span>
            </div>
            <div class="page-content">
                <img src="img/Component/A-button-ing Mazes.svg" class="diagram">
                <h2>On the Subject of A-button-ing Mazes</h2>
                <p class="flavour-text">These buttons are truly amazing! I’ve never pressed anything like them!</p>
                <ul>
                    <li>This module has a button facing in each of the four cardinal directions.</li>
                    <li>Each button has a different 5&#x00d7;5 maze with invisible walls on it, each with their own white start positions, red goal positions, and four red X markers indicating which of the mazes below is present on the button.<br>
                        The walls of the maze can be rotated or flipped into any orientation, reorienting the positions of the markers accordingly.</li>
                    <li>To move in the maze:<ul>
                            <li>Hold the button in the desired movement direction.<br>This will light up the held button in one of six colours.</li>
                            <li>Releasing the button will attempt to move the white pieces in the corresponding <i>pair of mazes</i> given by the table below in its direction.</li>
                            <li>If either piece hits a wall: the wall will become visible, a strike is incurred, and neither piece will move even if a wall was only hit in one of the mazes.</li>
                        </ul>
                    </li>
                    <li>Get all four pieces into the goal positions at the same time to solve the module.</li>
                </ul>
                <table>
                    <tr>
                        <th class="corner" colspan=2 rowspan=2></th>
                        <th colspan=6>Timer digit*</th>
                    </tr>
                    <tr><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th></tr>
                    <tr><th rowspan=6>Strip<br>Colour</th><th>Red</th><th>N &amp; E</th><th>N &amp; S</th><th>S &amp; E</th><th>S &amp; W</th><th>E &amp; W</th><th>N &amp; W</th></tr>
                    <tr><th>Blue</th><th>N &amp; S</th><th>S &amp; W</th><th>N &amp; E</th><th>N &amp; W</th><th>S &amp; E</th><th>E &amp; W</th></tr>
                    <tr><th>Yellow</th><th>S &amp; W</th><th>N &amp; W</th><th>N &amp; S</th><th>E &amp; W</th><th>N &amp; E</th><th>S &amp; E</th></tr>
                    <tr><th>Magenta</th><th>N &amp; W</th><th>E &amp; W</th><th>S &amp; W</th><th>S &amp; E</th><th>N &amp; S</th><th>N &amp; E</th></tr>
                    <tr><th>Cyan</th><th>E &amp; W</th><th>S &amp; E</th><th>N &amp; W</th><th>N &amp; E</th><th>S &amp; W</th><th>N &amp; S</th></tr>
                    <tr><th>White</th><th>S &amp; E</th><th>N &amp; E</th><th>E &amp; W</th><th>N &amp; S</th><th>N &amp; W</th><th>S &amp; W</th></tr>
                </table>
                <P>*The last seconds digit of the bomb timer <strong>unless</strong> it does not belong to any column of the table.
                    In that case, the next digit is used instead.</p>
            </div>
            <div class="page-footer relative-footer">Page 1 of 2</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">A-button-ing Mazes</span>
            </div>
            <div class="page-content">
                <div class="hstack wrap">
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/A.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/B.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/C.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/D.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/E.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/F.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/G.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/H.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/I.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/J.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/K.svg"></div></div>
                    <div class="holder"><div class="imgs"><img src="img/A-button-ing Mazes/L.svg"></div></div>
                </div>
            </div>
            <div class="page-footer relative-footer">Page 2 of 2</div>
        </div>
    </div>
</body>
</html>