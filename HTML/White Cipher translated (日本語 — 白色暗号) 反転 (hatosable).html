<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>反転白色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
        .alpha {
            font-size: 13px;
        }
        .beta {
            font-size: 11px;
        }

        .tablea {
            font-size: 14px;
        }
        .tableb {
            font-size: 20px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転白色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：反転白色暗号</h2>
                <p class="flavour-text">雪のように白いこの暗号は、処理担当者に溢れんばかりの苦痛を「なだれ」込ませる。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーに数字が表示される。</p>
                <p>ページ2には、上と真ん中のディスプレーに8文字の鍵が表示される。</p>
                <p>以下のルールに従って単語を解読する。</p>

                <h3>ステップ2：グリル転置</h3>
                <p>ここでは、ページ2にある上と真ん中のディスプレーの暗号文と真ん中のディスプレーにある8文字の鍵を使用する。</p>
                <p>2つの鍵を上のディスプレーの文字を先頭にして連結し、4×4の行列に読み順で配置する。</p>
                <p>その後、以下のグリッドを取得し、X回時計回りに90度回転させる。Xはポートの個数である。</p>
                <table>
                    <tr><th>X</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr>
                    <tr><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>X</th></tr>
                    <tr><th>&nbsp;</th><th>X</th><th>&nbsp;</th><th>X</th></tr>
                    <tr><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr>
                </table>
                <p>4×4行列の中からグリッド上のXと同じ位置にある英字を取り出す。取り出す際は読み順で取り出すように気をつける。その後90度時計回りに回転させる。</p>
                <p>これを追加で3回繰り返すと、暗号化された鍵を獲得できる。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    上のディスプレー：ENOIOCBS<br>
                    真ん中のディスプレー：BVBOLEHY<br>
                    ポートの個数：3<br>
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 1/6</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転白色暗号</span>
            </div>
            <div class="page-content">
                <table>
                    <tr><th>E</th><th>N</th><th>O</th><th>I</th><th>|</th><th></th><th>X</th><th>X</th><th>&nbsp;</th></tr>
                    <tr><th>O</th><th>C</th><th>B</th><th>S</th><th>|</th><th></th><th></th><th></th><th></th></tr>
                    <tr><th>B</th><th>V</th><th>B</th><th>O</th><th>|</th><th></th><th></th><th>X</th><th></th></tr>
                    <tr><th>L</th><th>E</th><th>H</th><th>Y</th><th>|</th><th>X</th><th></th><th></th><th></th></tr>
                </table>
                <p class="centered">NOBL</p>
                <table>
                    <tr><th>E</th><th>&nbsp;</th><th>&nbsp;</th><th>I</th><th>|</th><th>X</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr>
                    <tr><th>O</th><th>C</th><th>B</th><th>S</th><th>|</th><th></th><th></th><th></th><th>X</th></tr>
                    <tr><th>B</th><th>V</th><th>&nbsp;</th><th>O</th><th>|</th><th></th><th>X</th><th>&nbsp;</th><th>X</th></tr>
                    <tr><th>&nbsp;</th><th>E</th><th>H</th><th>Y</th><th>|</th><th>&nbsp;</th><th></th><th></th><th></th></tr>
                </table>
                <p class="centered">NOBL-ESVO</p>
                <table>
                    <tr><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>I</th><th>|</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>X</th></tr>
                    <tr><th>O</th><th>C</th><th>B</th><th>&nbsp;</th><th>|</th><th>&nbsp;</th><th>X</th><th></th><th>&nbsp;</th></tr>
                    <tr><th>B</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>|</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr>
                    <tr><th>&nbsp;</th><th>E</th><th>H</th><th>Y</th><th>|</th><th>&nbsp;</th><th>X</th><th>X</th><th></th></tr>
                </table>
                <p class="centered">NOBL-ESVO-ICEH</p>
                <table>
                    <tr><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>|</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr>
                    <tr><th>O</th><th>&nbsp;</th><th>B</th><th>&nbsp;</th><th>|</th><th>X</th><th>&nbsp;</th><th>X</th><th>&nbsp;</th></tr>
                    <tr><th>B</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>|</th><th>X</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr>
                    <tr><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>Y</th><th>|</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>X</th></tr>
                </table>
                <p class="centered">NOBL-ESVO-ICEH-OBBY</p>
                <p class="centered">復号された鍵：NOBLESVOICEHOBBY</p><br>
            </div>
            <div class="page-footer relative-footer">ページ 2/6</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転白色暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ2：ショーン暗号</h3>
                <p class="flavour-text">ショーン暗号へようこそ。この暗号はオリジナルなんだけど、そんなに気にしなくていいよ。</p>
                <p>ここでは、1ページ目の上のディスプレーに表示された暗号化された単語とステップ1で獲得した復号された鍵が必要になる。</p>
                <p>復号された鍵を獲得し、重複する英字の2文字目以降を削除する。次に、アルファベット全体の文字列を取得し、鍵に表示された英字を削除する。</p>
                <p>点灯したインジケーターの個数が偶数の場合、鍵の末尾にアルファベットの文字列を配置する。<br>そうでない場合、鍵の先頭にアルファベットの文字列を配置する。</p>
                <p>26文字の鍵を2つの長さ13の文字列に分割し前半部分の下に後半部分を配置する。これを今後「ショーン変換機」と呼ぶ。</p>
                <p>シリアルナンバーの2番目の英字のアルファベット上の位置が奇数の場合、セットAの手順に従う。そうでない場合、セットBの手順に従う。</p>
                <h3>手順セットA</h3>
                <p>暗号化された単語の各英字に対して、以下の手順に従う。</p>
                <ul>
                    <li>暗号化された単語の英字をショーン変換機から探し、その上/下にある英字に置き換える。</li>
                    <li>ショーン転置機の上半分の右端にある英字を、上半分の左端に配置する。</li>
                    <li>ショーン転置機の下半分にある左端の英字と上半分にある左端の英字を交換する。</li>
                    <li>ショーン転置機の下半分の左端にある英字を、下半分の右端に配置する。</li>
                </ul>
                <h3>手順セットB</h3>
                <p>暗号化された単語の各英字に対して、以下の手順に従う。</p>
                <ul>
                    <li>暗号化された単語の英字をショーン変換機から探し、その上/下にある英字に置き換える。</li>
                    <li>ショーン転置機の下半分の右端にある英字を、下半分の左端に配置する。</li>
                    <li>ショーン転置機の上半分にある左端の英字と下半分にある左端の英字を交換する。</li>
                    <li>ショーン転置機の上半分の左端にある英字を、上半分の右端に配置する。</li>
                </ul>

            </div>
            <div class="page-footer relative-footer">ページ 3/6</div>
        </div>
        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転白色暗号</span>
            </div>
            <div class="page-content">
                <p>これにより、新たな暗号化された単語が手に入るはずである。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：YISTHW<br>
                    鍵：NOBLESVICHYADFGJKMPQRTUWXZ<br>
                    シリアルナンバーの2番目の数字：奇数<br>手順セットBに従う
                </p>
                <table>
                    <tr><th>N</th><th>O</th><th>B</th><th>L</th><th>E</th><th>S</th><th>V</th><th>I</th><th>C</th><th>H</th><th>Y</th><th>A</th><th>D</th></tr>
                    <tr><th>F</th><th>G</th><th>J</th><th>K</th><th>M</th><th>P</th><th>Q</th><th>R</th><th>T</th><th>U</th><th>W</th><th>X</th><th>Z</th></tr>
                </table>
                <p class="centered">Y -> W</p>
                <table>
                    <tr><th>O</th><th>B</th><th>L</th><th>E</th><th>S</th><th>V</th><th>I</th><th>C</th><th>H</th><th>Y</th><th>A</th><th>D</th><th>Z</th></tr>
                    <tr><th>N</th><th>F</th><th>G</th><th>J</th><th>K</th><th>M</th><th>P</th><th>Q</th><th>R</th><th>T</th><th>U</th><th>W</th><th>X</th></tr>
                </table>
                <p class="centered">I -> P</p>
                <table>
                    <tr><th>B</th><th>L</th><th>E</th><th>S</th><th>V</th><th>I</th><th>C</th><th>H</th><th>Y</th><th>A</th><th>D</th><th>Z</th><th>X</th></tr>
                    <tr><th>O</th><th>N</th><th>F</th><th>G</th><th>J</th><th>K</th><th>M</th><th>P</th><th>Q</th><th>R</th><th>T</th><th>U</th><th>W</th></tr>
                </table>
                <p class="centered">S -> G</p>
                <table>
                    <tr><th>L</th><th>E</th><th>S</th><th>V</th><th>I</th><th>C</th><th>H</th><th>Y</th><th>A</th><th>D</th><th>Z</th><th>X</th><th>W</th></tr>
                    <tr><th>B</th><th>O</th><th>N</th><th>F</th><th>G</th><th>J</th><th>K</th><th>M</th><th>P</th><th>Q</th><th>R</th><th>T</th><th>U</th></tr>
                </table>
                <p class="centered">T -> X</p>
                <table>
                    <tr><th>E</th><th>S</th><th>V</th><th>I</th><th>C</th><th>H</th><th>Y</th><th>A</th><th>D</th><th>Z</th><th>X</th><th>W</th><th>U</th></tr>
                    <tr><th>L</th><th>B</th><th>O</th><th>N</th><th>F</th><th>G</th><th>J</th><th>K</th><th>M</th><th>P</th><th>Q</th><th>R</th><th>T</th></tr>
                </table>
                <p class="centered">H -> G</p>
                <table>
                    <tr><th>S</th><th>V</th><th>I</th><th>C</th><th>H</th><th>Y</th><th>A</th><th>D</th><th>Z</th><th>X</th><th>W</th><th>U</th><th>T</th></tr>
                    <tr><th>E</th><th>L</th><th>B</th><th>O</th><th>N</th><th>F</th><th>G</th><th>J</th><th>K</th><th>M</th><th>P</th><th>Q</th><th>R</th></tr>
                </table>
                <p class="centered">W -> P</p>
                <p class="centered">
                    新たな暗号化された単語：WPGXGP
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 4/6</div>
        </div>
        <div class="page page-bg-05">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転白色暗号</span>
            </div>
            <div class="page-content">
                <h3>ステップ3：基数カエサル暗号</h3>
                <p>ここでは、ステップ2で獲得した暗号化された単語と1ページ目の真ん中のディスプレーにある数字を使用する。</p>
                <p>真ん中のディスプレーにある数字は暗号化された単語の各英字をずらすために使用される。ただし、この数字は十進数とは限らない。</p>
                <p>基数を求めるには、暗号化された単語の各英字のアルファベット上の位置(A = 1, B = 2, ... Z = 26)を合計する。その後、合計を8でモジュロ(0から7の間の数になるまで繰り返し8を減算)し、2を加算する。結果の数字がこの数字の基数となる。</p>
                <p>数字を十進数に変換するには、以下の手順に従う。</p>
                <ul>
                    <li>1：数字(真ん中のディスプレー)の各桁の上に、その桁が表す基数のべき乗を記す。乗数は右端の0から開始し、左に一桁ずつ進むたびに1増加する。</li>
                    <li>2：基数のべき乗と各桁の数字を乗算する。</li>
                    <li>3：全ての数を合計すると、十進数での数字が求められる。</li>
                </ul>
                <p>十進数に変換したら、アルファベット上の位置(A = 1, B = 2, ... Z = 26)を利用して暗号化された単語の各英字から減算し、26でモジュロし、英字に変換することで新たな暗号化された単語を得る。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：WPGXGP<br>
                    真ん中のディスプレーの数字：105<br>
                    基数：23 + 16 + 7 + 24 + 7 + 16 = 93 % 8 = 5 + 2 = 7
                </p>
                <p class="centered">
                    7<sup>2</sup> 7<sup>1</sup> 7<sup>0</sup><br>
                    1&nbsp;&nbsp;0&nbsp;&nbsp;5<br>
                    7<sup>2</sup> * 1 = 49<br>
                    7<sup>1</sup> * 0 = 0<br>
                    7<sup>0</sup> * 5 = 5<br>
                    49 + 0 + 5 = 54(十進数表記)
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 5/6</div>
        </div>
        <div class="page page-bg-06">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転白色暗号</span>
            </div>
            <div class="page-content">
                <p class="centered">
                    (より簡単に計算するために): 54 % 26 = 2<br>
                    W = 23 - 2 = 21 % 26 = 21 = U<br>
                    P = 16 - 2 = 14 % 26 = 14 = N<br>
                    G = 7 - 2 = 5 % 26 = 5 = E<br>
                    X = 24 - 2 = 22 % 26 = 22 = V<br>
                    G = 7 - 2 = 5 % 26 = 5 = E<br>
                    P = 16 - 2 = 14 % 26 = 14 = N<br>
                    復号された単語：UNEVEN
                </p>
                <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>

                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>

                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>
            </div>
            <div class="page-footer relative-footer">ページ 6/6</div>
        </div>
    </div>
</body>
</html>