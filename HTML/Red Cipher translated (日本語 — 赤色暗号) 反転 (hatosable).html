<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>反転赤色暗号 — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/font-japanese.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/ktane-utils.js"></script>
    <style>
        table {
            margin: 1em auto;
        }
        .strip-change-one td,
        .strip-change-one th {
            padding: .3em .5em .2em;
        }
    </style>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転赤色暗号</span>
            </div>
            <div class="page-content">
                <img src="img/Component/Ultimate Cipher.svg" class="diagram">
                <h2>モジュール詳細：反転赤色暗号</h2>
                <p class="flavour-text">赤を眺めることは、このモジュール上ではごく普通だ。</p>
                <p>モジュールは、3つのディスプレー、キーボード、2つの矢印、及び現在のページを表示するボタン(送信ボタン)で構成されている。</p>
                <p>右の矢印を押すと、次のページに移動できる。左の矢印を押すと前のページに移動できる。ページは全部で2ページある。</p>
                <p>ページ1には、上のディスプレーに6文字の暗号化された単語、真ん中のディスプレーに6文字の文字列が表示される。暗号化された単語に「J」が含まれている場合、同じ位置にある真ん中のディスプレーの文字に置き換える。3ステップ完了後、その文字を再び「J」に戻す。</p>
                <p>ページ2には、3つのディスプレーすべてに単語が表示される。上の単語はキーワード1、真ん中の単語はキーワード2、下の単語はキーワード3になる。</p>
                <p>以下のルールに従って単語を解読する。</p>
                <h3>ステップ1：三枡暗号</h3>
                <p>このステップでは3つの行列とページ1の上のディスプレーに表示された暗号化された単語が必要となる。</p>
                <p>1つ目の行列を作成するには、キーワード1にJがある場合はそれをIに変換し、重複する英字の2文字目以降を削除する。それから、アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの最初の数字が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを5×5の行列の形に配置する。</p>
                <p>2つ目の行列を作成するには、キーワード2にJがある場合はそれをIに変換し、重複する英字の2文字目以降を削除する。それから、アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの二番目の数字が偶数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>

            </div>
            <div class="page-footer relative-footer">ページ 1/5</div>
        </div>

        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転赤色暗号</span>
            </div>
            <div class="page-content">
                <p>長さが25の文字列を取得したら、それを別の5×5の行列の形に配置する。</p>
                <p>3つ目の行列を作成するには、キーワード3にJがある場合はそれをIに変換し、重複する英字の2文字目以降を削除する。それから、アルファベット全体の文字列(Jを除外)を取得し、キーワードに表示された英字を削除する。</p>
                <p>シリアルナンバーの最後の数字が奇数の場合、キーワードの末尾にアルファベットの文字列を配置する。そうでない場合、キーワードの先頭にアルファベットの文字列を配置する。</p>
                <p>長さが25の文字列を取得したら、それを別の5×5の行列の形に配置する。これで3つの行列が揃う。</p>
                <p>>暗号化された単語を3組の英字のペアに分割する。各ペアに対して、以下の処理を行う。</p>
                <ul>
                    <li>最初の英字を1つ目の行列から探し、その行と列を取得する。</li>
                    <li>次に、2番目の英字を2つ目の行列から探し、その行と列を取得する。</li>
                    <li>1つ目の行列の行と2つ目の行列の列を3つ目の行列に使用し、最初の英字を得る。</li>
                    <li>1つ目の行列の列と2つ目の行列の行を3つ目の行列に使用し、2番目の英字を得る。</li>
                </ul>
                <p>出来上がった文字が新しい暗号化された単語となる。</p>

            </div>
            <div class="page-footer relative-footer">ページ 2/5</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転赤色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：BEWCSG<br>
                    キー1：MALBCDEFGHIKNOPQRSTUVWXYZ<br>
                    キー2：ABCDFGIKLMNOQTUVWXYZSPHER<br>
                    キー3：ABCDEFGIKLNPQSTVWXYZHUMOR
                </p>
                <table>
                    <tr><th>M</th><th>A</th><th>L</th><th>B</th><th>C</th><th>|</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>|</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr>
                    <tr><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>|</th><th>G</th><th>I</th><th>K</th><th>L</th><th>M</th><th>|</th><th>F</th><th>G</th><th>I</th><th>K</th><th>L</th></tr>
                    <tr><th>I</th><th>K</th><th>N</th><th>O</th><th>P</th><th>|</th><th>N</th><th>O</th><th>Q</th><th>T</th><th>U</th><th>|</th><th>N</th><th>P</th><th>Q</th><th>S</th><th>T</th></tr>
                    <tr><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>|</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>|</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                    <tr><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>|</th><th>S</th><th>P</th><th>H</th><th>E</th><th>R</th><th>|</th><th>H</th><th>U</th><th>M</th><th>O</th><th>R</th></tr>
                </table>
                <p class="centered">
                    BE -> DO<br>
                    WC -> MB<br>
                    SG -> VI<br>
                    新たな暗号化された単語：DOMBVI
                </p>

                <h3>ステップ2：共役行列分割</h3>
                <p>このステップでは、ステップ1でキーワード1とキーワード2を用いて作成した2つの行列と暗号化された単語が必要となる。</p>
                <p>暗号化された単語の各英字ごとに以下の手順に従う。</p>
                <ul>
                    <li>1つ目の行列から数字の組を見つける。</li>
                    <li>上の数字が行、下の数字が列になるように行と列の数字の組を並べる。</li>
                    <li>ひとつ前の行と列の数字の組の右隣に並べた数字を書き留める。</li>
                </ul>
                <p>数字全体を読み順で読み取り、それを6組の数字のペアに分割する。</p>
                <p>これらの数字を行／列の数字として2つ目の行列に使用し、新たな英字を獲得する。</p>
                <p>出来上がった文字が新しい暗号化された単語となる。</p>
            </div>
            <div class="page-footer relative-footer">ページ 3/5</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転赤色暗号</span>
            </div>
            <div class="page-content">
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：DOMBVI<br>
                </p>
                <table>
                    <tr><th></th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>|</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th></th></tr>
                    <tr><th>1</th><th>M</th><th>A</th><th>L</th><th>B</th><th>C</th><th>|</th><th>A</th><th>B</th><th>C</th><th>D</th><th>F</th><th>1</th></tr>
                    <tr><th>2</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>|</th><th>G</th><th>I</th><th>K</th><th>L</th><th>M</th><th>2</th></tr>
                    <tr><th>3</th><th>I</th><th>K</th><th>N</th><th>O</th><th>P</th><th>|</th><th>N</th><th>O</th><th>Q</th><th>T</th><th>U</th><th>3</th></tr>
                    <tr><th>4</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>|</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>4</th></tr>
                    <tr><th>5</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th><th>|</th><th>S</th><th>P</th><th>H</th><th>E</th><th>R</th><th>5</th></tr>
                </table>
                <p class="centered">
                    D -> 21<br>
                    O -> 34<br>
                    M -> 11<br>
                    B -> 14<br>
                    V -> 51<br>
                    I -> 31
                </p>
                <table>
                    <tr><th>2</th><th>3</th><th>1</th><th>1</th><th>5</th><th>3</th></tr>
                    <tr><th>1</th><th>4</th><th>1</th><th>4</th><th>1</th><th>1</th></tr>
                </table>
                <p class="centered">
                    23 -> K<br>
                    11 -> A<br>
                    53 -> H<br>
                    14 -> D<br>
                    14 -> D<br>
                    11 -> A<br>
                    新たな暗号化された単語：KAHDDA
                </p>
            </div>
            <div class="page-footer relative-footer">ページ 4/5</div>
        </div>

        <div class="page page-bg-04">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">反転赤色暗号</span>
            </div>
            <div class="page-content">

                <h3>ステップ3：プレイフェア暗号</h3>
                <p>このステップでは、ステップ1でキーワード1を用いて作成された行列とステップ2で取得した暗号化された単語が必要になる。</p>
                <p>暗号化された文字列を2つずつのペアに分割し、各ペアについて以下の手順を実行する。</p>

                <ul>
                    <li>2つの英字が全く同じ場合、その英字を保持する。</li>
                    <li>そうでない場合、その英字が行列の同じ行に存在するなら、その左隣にある英字にペアの英字を置き換える。段の端はループする。</li>
                    <li>そうでない場合、その英字が行列の同じ列に存在するなら、その真上にある英字にペアの英字を置き換える。列の端はループする。</li>
                    <li>そうでない場合、その英字と同じ行にあり、ペアのもう一方の英字と同じ列にある英字にそれぞれ置き換える。</li>
                </ul>
                <p>最初にJであった英字をJに置き換えることで、復号された単語を取得できることに注意すること。</p>
                <h4 class="centered">例</h4>
                <p class="centered">
                    暗号化された単語：KAHDDA
                </p>
                <table>
                    <tr><th>M</th><th>A</th><th>L</th><th>B</th><th>C</th></tr>
                    <tr><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th></tr>
                    <tr><th>I</th><th>K</th><th>N</th><th>O</th><th>P</th></tr>
                    <tr><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th></tr>
                    <tr><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr>
                </table>
                <p class="centered">
                    KA -> RE<br>
                    HD -> DE<br>
                    DA -> EM<br>
                    復号された単語：REDEEM
                </p>
                 <p>復号された単語を取得したら、それを送信する。入力を開始すると、全てのディスプレーが暗転し下のディスプレーに入力された文字が表示される。</p>
                <p>入力を消去するには、いずれかの矢印をクリックする。ページが移動し、入力した文字列が消去される。6文字を超える入力はできないようになっている。</p>
                <p>入力に問題がなければ、「SUB」と書かれたボタンを押して、回答を送信する。ミスが記録された場合、モジュールの最初のページに戻るが、暗号の再生成はされない。</p>

            </div>
            <div class="page-footer relative-footer">ページ 5/5</div>
        </div>
    </div>
</body>
</html>